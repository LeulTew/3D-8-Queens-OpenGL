EMCC=emcc

# Source files
SOURCES=main.cpp

# Output files
OUTPUT=index.html

# Emscripten flags
EMFLAGS= \
	-s LEGACY_GL_EMULATION=1 \
	-s GL_UNSAFE_OPTS=0 \
	-s WASM=1 \
	-s ALLOW_MEMORY_GROWTH=1 \
	-s EXPORTED_RUNTIME_METHODS='["ccall","cwrap"]' \
	-s EXPORTED_FUNCTIONS='["_main"]' \
	--preload-file resources@/resources \
	--use-preload-plugins \
	-I. \
	-std=c++11 \
	-O2 \
	-lopenal

# Build target
$(OUTPUT): $(SOURCES)
	$(EMCC) $(SOURCES) $(EMFLAGS) -o $(OUTPUT)

# Clean target
clean:
	rm -f $(OUTPUT) *.wasm *.data

.PHONY: clean